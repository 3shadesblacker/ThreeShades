on: push
name: Deploy website on push
jobs:
  web-deploy:
    name: Deploy
    runs-on: windows-latest
    steps:
    - name: Install .NET
      run: |
          Invoke-WebRequest -Uri https://dot.net/v1/dotnet-install.ps1 -OutFile dotnet-install.ps1
          ./dotnet-install.ps1 -InstallDir $env:USERPROFILE\dotnet -Runtime aspnetcore

    - name: Build and publish application
      run: |
          dotnet restore
          dotnet publish -c Release -o publish
    - name: Get latest code
      uses: actions/checkout@v3

    - name: Deploy application
      uses: SamKirkland/FTP-Deploy-Action@4.3.3
      with:
        server: files.000webhost.com
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        server-dir: public_html/
        local-dir: ./publish
        args: --delete
